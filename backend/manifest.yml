name: FlavorForge

entities:
  users:
    authenticable: true
    properties:
      - name: name
        type: string
        validation:
          required: true
      - name: email
        type: email
        validation:
          required: true
      - name: avatar
        type: image
        options:
          sizes:
            thumbnail:
              width: 100
              height: 100
            profile:
              width: 300
              height: 300
      - name: bio
        type: richText
        validation:
          maxLength: 1000
      - name: role
        type: choice
        options:
          values: [user, chef, admin]
        default: user
    belongsToMany:
      - name: favoriteRecipes
        entity: recipes
    policies:
      create:
        - access: admin
      read:
        - access: public
      update:
        - access: restricted
          allow: users
          condition: self
        - access: admin
      delete:
        - access: admin
      signup:
        - access: public

  recipes:
    properties:
      - name: title
        type: string
        validation:
          required: true
          minLength: 5
          maxLength: 150
      - name: description
        type: textarea
        validation:
          required: true
          maxLength: 500
      - name: ingredients
        type: richText
        validation:
          required: true
      - name: instructions
        type: richText
        validation:
          required: true
      - name: prepTime
        type: number
        validation:
          min: 0
      - name: cookTime
        type: number
        validation:
          min: 0
      - name: difficulty
        type: choice
        options:
          values: [Easy, Medium, Hard]
        default: Medium
      - name: mainImage
        type: image
        validation:
          required: true
        options:
          sizes:
            thumbnail:
              width: 400
              height: 300
            large:
              width: 1200
              height: 900
      - name: status
        type: choice
        options:
          values: [draft, published]
        default: draft
      - name: publishedAt
        type: timestamp
    belongsTo:
      - name: author
        entity: users
    belongsToMany:
      - name: categories
        entity: categories
    policies:
      create:
        - access: restricted
          allow: users
      read:
        - access: public
      update:
        - access: restricted
          allow: users
          condition: self
        - access: admin
      delete:
        - access: restricted
          allow: users
          condition: self
        - access: admin

  reviews:
    properties:
      - name: rating
        type: number
        validation:
          required: true
          min: 1
          max: 5
      - name: comment
        type: textarea
        validation:
          required: true
          minLength: 10
      - name: createdAt
        type: timestamp
        default: now
    belongsTo:
      - name: reviewer
        entity: users
      - name: recipe
        entity: recipes
    policies:
      create:
        - access: restricted
          allow: users
      read:
        - access: public
      update:
        - access: restricted
          allow: users
          condition: self
        - access: admin
      delete:
        - access: restricted
          allow: users
          condition: self
        - access: admin

  categories:
    properties:
      - name: name
        type: string
        validation:
          required: true
      - name: description
        type: textarea
    policies:
      create:
        - access: admin
      read:
        - access: public
      update:
        - access: admin
      delete:
        - access: admin

endpoints:
  health:
    path: /health
    method: GET
    handler: health
    policies:
      - access: public


# Health check endpoint for connection testing
endpoints:
  health:
    path: /api/health
    method: GET
    policies: []
    handler: healthCheck